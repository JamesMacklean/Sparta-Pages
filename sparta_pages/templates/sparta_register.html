{% extends "sparta_base.html" %}
{% load static %}

{% block sparta_body %}

<div class="card">
  <div class="card-body">
    <h2 class="card-title">Register to become a SPARTA Scholar</h2>
    <div>
      To become a SPARTA Scholar and gain free access to the data analytics courses, you must complete your scholar profile and submit the following eligibility documents:
      <ul>
        <li><b>Proof of Education</b> - A scanned image or a clear photograph of your certificate of graduation or diploma.</li>
        <li><b>Proof of Agreement</b></li>
      </ul>
    </div>

    <h3>Education Profile</h3>
    {{ educationFormset.management_form }}
    {% for form in educationFormset.forms %}
        <div class='table'>
        <table class='no_error'>
            {{ form.as_table }}
        </table>
        </div>
    {% endfor %}
    <input type="button" value="Add More" id="add_more">
    <script>
        $('#add_more').click(function() {
            cloneMore('div.table:last', 'education');
        });
    </script>

    <h3>Employment Profile</h3>
    {{ employmentFormset.management_form }}
    {% for form in employmentFormset.forms %}
        <div class='table'>
        <table class='no_error'>
            {{ form.as_table }}
        </table>
        </div>
    {% endfor %}
    <input type="button" value="Add More" id="add_more">
    <script>
        $('#add_more').click(function() {
            cloneMore('div.table:last', 'employment');
        });
    </script>

    <h3>Training Profile</h3>
    {{ trainingFormset.management_form }}
    {% for form in trainingFormset.forms %}
        <div class='table'>
        <table class='no_error'>
            {{ form.as_table }}
        </table>
        </div>
    {% endfor %}
    <input type="button" value="Add More" id="add_more">
    <script>
        $('#add_more').click(function() {
            cloneMore('div.table:last', 'training');
        });
    </script>

    <h3>Eligibility Documents</h3>
    {% if form.is_multipart %}
      <form enctype="multipart/form-data" method="post" action="{% url 'sparta-register' %}">
    {% else %}
      <form method="post" action="{% url 'sparta-register' %}">
    {% endif %}
      <div class="form-group">
        {% csrf_token %}
        {{ sparta_profile_form.non_field_errors }}
        <div class="fieldWrapper">
            {{ sparta_profile_form.proof_of_education_file.errors }}
            <label for="{{ sparta_profile_form.proof_of_education_file.id_for_label }}" style="font-family: inherit;font-style: inherit;">Proof of Education:</label>
            {{ sparta_profile_form.proof_of_education_file }}
        </div>
        <div class="fieldWrapper">
            {{ sparta_profile_form.proof_of_agreement_file.errors }}
            <label for="{{ sparta_profile_form.proof_of_agreement_file.id_for_label }}" style="font-family: inherit;font-style: inherit;">Proof of Agreement:</label>
            {{ sparta_profile_form.proof_of_agreement_file }}
            <div class=""><a href="#">Download the form here</a></div>
        </div>
        <input type="submit" value="Submit" />
      </div>
      </form>
    </div>
</div>

<script type="text/javascript">
  function cloneMore(selector, type) {
    var newElement = $(selector).clone(true);
    var total = $('#id_' + type + '-TOTAL_FORMS').val();
    newElement.find(':input').each(function() {
        var name = $(this).attr('name').replace('-' + (total-1) + '-','-' + total + '-');
        var id = 'id_' + name;
        $(this).attr({'name': name, 'id': id}).val('').removeAttr('checked');
    });
    newElement.find('label').each(function() {
        var newFor = $(this).attr('for').replace('-' + (total-1) + '-','-' + total + '-');
        $(this).attr('for', newFor);
    });
    total++;
    $('#id_' + type + '-TOTAL_FORMS').val(total);
    $(selector).after(newElement);
  }
</script>
{% endblock %}
